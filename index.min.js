/**Log functions. @preserve Copyright (c) 2021 Manuel LÃµhmus.*/
function checkSize(){var n,t;if(counter>0){counter--;return}counter=100;n=filenames.map(function(n){var t=path.resolve(logDir,logDailyName(n));return fs.existsSync(t)?fs.statSync(t).size:0}).reduce(function(n,t){return n+t},0);n>262144&&(t=(new Date).toISOString().replace("T"," ").replace("Z","").replaceAll(":"," ").split(".")[0],filenames.forEach(function(n){var r=logDailyName(n),i=logDailyName(t+" "+n);if(fs.existsSync(r)){fs.renameSync(r,i);var u=fs.createReadStream(i,{flag:"r+"}),f=fs.createWriteStream(i+".gz",{flag:"w+"}),e=zlib.createGzip();u.pipe(e).pipe(f).on("finish",function(){fs.unlink(i,function(n){n&&console.error(n)})})}}))}function logDailyName(n){return path.resolve(logDir,n+".log")}function writeToLogFile(n,t,i=false){if(options.enabled){checkSize();const r=(new Date).toISOString()+"  ",u=logDailyName(n);if(i)try{fs.appendFileSync(u,r+t,{flag:"a+"})}catch(r){console.error(r)}else fs.appendFile(u,r+t,{flag:"a+"},function(n){n&&console.error(n)})}return t}function clear(){options.enabled&&filenames.forEach(function(n){fs.existsSync(logDailyName(n))&&fs.writeFileSync(logDailyName(n),"")})}"use strict";var options=require("config-sets").init({log_report:{logDir:"./log/log-report",clear_on_startup:!0,save_only_uncaughtException:!0,enabled:!0}}).log_report,zlib=require("zlib"),fs=require("fs"),path=require("path"),logDir=path.resolve(options.logDir),filenames=["stdout","stderr","error"],counter=100;exports.clear=clear;options.clear_on_startup&&clear();fs.existsSync(logDir)||fs.mkdirSync(logDir,{recursive:!0});const stdoutWrite0=process.stdout.write;process.stdout.write=function(n){return options.save_only_uncaughtException||writeToLogFile("stdout",n),n=Array.isArray(n)?n:[n],stdoutWrite0.apply(process.stdout,n)};const stderrWrite0=process.stderr.write;process.stderr.write=function(n){return options.save_only_uncaughtException||writeToLogFile("stderr",n),n=Array.isArray(n)?n:[n],stderrWrite0.apply(process.stderr,n)};process.on("uncaughtException",function(n){writeToLogFile("error",(n&&n.stack?n.stack:n)+"\n",!0);process.exit(1)});